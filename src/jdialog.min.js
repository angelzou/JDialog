define(["jquery","jqueryUI","jdialog"],function(a,b,c){function d(b){this.config=a.extend({width:"",height:"",title:"JDialog",content:"<span>JDialog content<span>",close:null,ok:null,okVal:"ok",cacel:null,cacelVal:"cacel",cacelDisplay:"true",skin:"",cssUri:"../css/ui-jdialog.css",isModal:!1,maskBg:"#000",maskOpacity:.7,isDrag:!0,dragHandler:".ui-jdialog-header",innerHTML:'<div class="ui-jdialog-main"><div jd="header" class="ui-jdialog-header"><button jd="close" class="ui-jdialog-close">&#215;</button><div jd="title" class="ui-jdialog-title"></div></div><div jd="content" class="ui-jdialog-content"></div><div jd="footer" class="ui-jdialog-footer"><div jd="button" class="ui-jdialog-btn"></div></div></div>'},b)}return d.prototype={_init:function(){var b=this._wrapLayer=a("<div />").addClass("ui-jdialog").attr("jd","dialog").html(this.config.innerHTML).appendTo("body"),c=this.config;this.config._wrapLayer=b,c.title&&this.setTitle(this.config.title),"string"==typeof c.content&&this.setContent(this.config.content),c.isModal&&(this.config._maskObj=maskObj=a('<div class="ui-jdialog-mask"></div>'),maskObj.appendTo("body"),"string"==typeof c.maskBg&&maskObj.css({background:c.maskBg}),"number"==typeof c.maskOpacity&&maskObj.css({opacity:c.maskOpacity,filter:"alpha(opacity="+100*c.maskOpacity+")"}));var e=a.extend({},d.prototype,c);if(c.isModal&&maskObj.click(function(){e.removeWrap()}),"function"==typeof c.cacel){this._find("button").append('<button jd="cacel" class="ui-jdialog-btn-default"></button>');var f=this._find("cacel");"string"==typeof c.cacelVal&&f.text(c.cacelVal),f.click(function(){c.cacel.apply(e,arguments)})}if("function"==typeof c.ok){this._find("button").append('<button jd="ok" class="ui-jdialog-btn-default ui-jdialog-btn-primary"></button>');var g=this._find("ok");"string"==typeof c.okVal&&g.text(c.okVal),g.click(function(){c.ok.call(e,arguments)})}"function"==typeof c.close?this._find("close").click(function(){c.close.call(e,arguments),e.removeWrap()}):this._find("close").addClass("ui-jdialog-hidden"),c.skin&&b.addClass(c.skin),c.isDrag&&(c.dragHandler&&b.draggable({handle:c.dragHandler}),b.draggable()),this._setCenter(b)},listen:function(){},show:function(){return this._init(),this},showModal:function(){return this.config.isModal=!0,this.show.apply(this,arguments)},setContent:function(a){return this._find("content").html(a),this},setTitle:function(a){return this._find("title").text(a),this},removeWrap:function(){this.isModal&&this._maskObj.remove(),this._wrapLayer.remove()},_find:function(a){return this._wrapLayer.find("[jd="+a+"]")},_setCenter:function(a){var b=document.documentElement.clientWidth||document.body.clientWidth,c=document.documentElement.clientHeight||document.body.clientHeight,d=(document.documentElement.scrollLeft||document.body.scrollLeft,document.documentElement.scrollTop||document.body.scrollTop,a.width()),e=a.height(),f=(b-d)/2/b*100+"%",g=(c-e)/2/c*100+"%";a.css({position:"fixed",top:g,left:f})}},d});